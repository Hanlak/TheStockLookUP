<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>Stock Suggestions LookUP</title>
    <style>
    a, a:hover, a:focus, a:active {
      text-decoration: none;
      color: inherit;
    }
        h5 {
            color: #EE1C0B;
            font: 1.2em "Fira Sans", sans-serif;
        }
        .header{
         background-color: #ECEBE9;
        }
        body {
        background-color:#B5C5A8;
        }

    </style>
    <script src="formx.js"></script>
    <script>
    function post_to_url(path, params, method) {
    method = method || "POST";

    var form = document.createElement("form");
    form.setAttribute("method", method);
    form.setAttribute("action", path);

    for(var key in params) {
        if(params.hasOwnProperty(key)) {
            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
         }
    }

    document.body.appendChild(form);
    form.submit();
    form.reset();
}
function mainFormSubmit(){
    var stockName = document.getElementById('stockName').value;
    var createdAt = document.getElementById('createdAt').value;
    var type = document.getElementById('types1').value;
    if((stockName == null || stockName =="") && (createdAt == null || createdAt=="") && type == 'NONE'){
        alert("atleast you have give to one search field");
    }
    else if((stockName!=null && stockName!="") && (createdAt == null || createdAt == "") && type =='NONE'){
        post_to_url('/v1/thestocker/getter/getallsuggestionsbyname', { stockName:stockName}, 'POST');
    }else if((stockName ==null || stockName =="") && (createdAt==null || createdAt=="") && type != 'NONE'){
     post_to_url('/v1/thestocker/getter/getallsuggesstionsbytype', { type:type}, 'POST');
    }else if((stockName !=null && stockName !="") && (createdAt!=null && createdAt!="") && type == 'NONE'){
    post_to_url('/v1/thestocker/getter/getbynameanddate', { stockName:stockName,createdAt:createdAt }, 'POST');
    }
    else if((stockName !=null && stockName !="") && (createdAt!=null && createdAt!="") && type != 'NONE'){
    post_to_url('/v1/thestocker/getter/getbynameanddateandtype', { stockName:stockName,createdAt:createdAt, type:type }, 'POST');
    }else if((stockName == null || stockName =="") && (createdAt != null || createdAt!="") && type == 'NONE'){
    alert("please choose date with stockname and type or just stockname.");
    }
    else if((stockName == null || stockName =="") && (createdAt != null || createdAt!="") && type != 'NONE'){
    alert("please choose date with stockname and type or just stockname.");
    }
}
function homeFormSubmit() {
    document.forms["homeForm"].submit();
}
function formSubmit() {
    document.forms["myForm"].submit();
}

    </script>
</head>
<body>
<div class="header">
    <div style="background-color:#ECEBE9;">
        <nav class="navbar navbar-light bg-light justify-content-between"
             style="color:#0D0BF6;font-family: monospace;font-size: 50px;">
            <h2>
                <form action="/" method="GET" name="homeForm"><a onclick="homeFormSubmit()" style="font-size=20px;">
                    STOCK SUGGESTIONS LOOKUP</a></form>
            </h2>
        </nav>
    </div>
    <div class="container-fluid">
        <div class="form-inline">
            <h5>Search By Name, Creation Date and Type (ADV) </h5>
            <div class="form-group">
                <label for="stockName">Stock Name</label>
                <input aria-label="Search" class="form-control mr-sm-2" id="stockName" name="stockName"
                       placeholder="StockName" type="search">
            </div>
            <div class="form-group">
                <label for="createdAt">Created On </label>
                <div class='input-group date'>
                    <input class="form-control" id="createdAt" name="createdAt" type='date'/>
                </div>
            </div>
            <div class="form-group">
                <label for="types1">Choose a Suggestion type:</label>
                <select id="types1" name="types1">
                    <option value="NONE">NONE</option>
                    <option value="BUY">BUY</option>
                    <option value="SELL">SELL</option>
                </select>
            </div>
        </div>
        <button class="btn btn-primary" onclick="mainFormSubmit()" type="submit">Search</button>
    </div>
</div>
<br/>
<!-- BEGGING OF RESULT VIEW -->
<div class="result">
    <div th:if="${not #lists.isEmpty(suggestList)}">
        <div class="container-fluid">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>Stock Name</th>
                    <th>Buy At</th>
                    <th>Stop Loss</th>
                    <th>Sell In</th>
                    <th>Target Price</th>
                    <th>Created On</th>
                    <th>Type</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="suggest : ${suggestList}">
                    <td th:text="${suggest.stockName}">Stock Name</td>
                    <td th:text="${suggest.buyAt}">Buy At</td>
                    <td th:text="${suggest.stopLoss}">Stop Loss</td>
                    <td th:text="${suggest.sellAt}">Sell In</td>
                    <td th:text="${suggest.targetPrice}">Target Price</td>
                    <td th:text="${suggest.createdAt}">Created On</td>
                    <td th:text="${suggest.type}">type</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div th:if="${ #lists.isEmpty(suggestList)}">
        <div class="container">
            <h2 style="color: red; text-align = center;" th:text="${error}"></h2>
            <div th:if="${home} == 'home'">
                <form action="/v1/thestocker/getter/getallsuggestions" method="GET" name="myForm">
                    <button><a onclick="formSubmit()" style="font-size=20px;"> Click here</a></button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- BEGGING OF RESULT VIEW -->
</body>
</html>